一句话概括
基于JAX的可微分光栅化器，将矢量图形（如路径、形状等）转换为像素图像，并且支持通过梯度下降优化图元参数以匹配目标图像。
输入通常包括：
1. 目标图像：我们希望生成的渲染图像与之匹配的图像。
2. 初始几何参数：需要优化的图元（如圆形、矩形、三角形）的初始参数（位置、大小、颜色等）
核心流程
几何图元定义
● Circle：圆形，包含中心点、半径和颜色
● Rectangle：矩形，包含中心点、尺寸、旋转角度和颜色
● Triangle：三角形
● Capsule：胶囊
● Trapezoid：梯形
● Arc：圆弧
符号距离函数(SDF)
● circle_sdf：计算点到圆形的符号距离
● rectangle_sdf：计算点到旋转矩形的符号距离
● ......
可微光栅化
将几何图元（如圆形、矩形）转换为图像，用于：
1. 逆向图形学：从图像反推几何形状
2. 形状优化：通过梯度下降优化几何参数
核心原理
基于带符号距离函数 (SDF)和alpha 混合实现：
1. SDF：计算每个点到图元边界的距离（内部为负，外部为正）
2. Sigmoid 转换：将 SDF 值转换为透明度（alpha），控制边界的平滑度
3. 混合算法：按照渲染顺序合并多个图元的颜色和透明度
优化流程：
● 加载初始图元参数和目标图像
● 使用Adam优化器调整图元参数
● 通过损失函数优化渲染结果
具体实现
1. SDF值计算
计算每个图元在每个像素点的SDF值（有符号距离函数），得到一个[M, N]的矩阵（M个图元，N个像素）。
 2. SDF转覆盖度alpha
通过sigmoid函数将SDF值转换为覆盖度alpha（coverage_alpha），并用图元的基础alpha（base_alphas）进行缩放，得到最终每个图元在每个像素上的alpha（final_alpha）。
 3. 计算深度权重（depth_weights）
使用softmax在深度上（注意：这里深度是图元的深度，每个图元一个深度值）进行归一化，使得深度较大的图元（更靠近相机）权重更大。
 4. 计算每个图元在每个像素的权重
权重 = 深度权重 * final_alpha。然后对每个像素的所有图元权重进行归一化（除以权重和）。
 5. 预乘颜色
将每个图元的RGB颜色乘以其final_alpha（每个像素的alpha），得到预乘颜色。
 6. 混合
使用归一化后的权重对预乘颜色进行加权求和，得到每个像素的RGB值；对final_alpha用同样的权重加权求和得到每个像素的alpha。


全白图元最终图像使用optimized_differentiable_rasterize，有黑有白用binary_rasterize
